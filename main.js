(()=>{"use strict";var e={d:(t,n)=>{for(var o in n)e.o(n,o)&&!e.o(t,o)&&Object.defineProperty(t,o,{enumerable:!0,get:n[o]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t)};function t(e){e.classList.add("popup_opened"),document.addEventListener("keydown",c)}function n(e){e.classList.remove("popup_opened"),document.removeEventListener("keydown",c)}function o(e){var t=document.querySelector(".popup_opened");e.target.classList.contains("popup")&&n(t)}function c(e){var t=document.querySelector(".popup_opened");"Escape"===e.key&&n(t)}e.d({},{OP:()=>h,cM:()=>A,b3:()=>P});var r={url:"https://nomoreparties.co/v1/plus-cohort7/",myId:"e5c6b7df9e7fbe0fcc954a79",headers:{authorization:"55f6dcbe-e189-42c3-b858-3cc6208e5fc5","Content-Type":"application/json"}},i=function(e,t,n){return fetch("".concat(r.url,"users/me"),{headers:r.headers}).then((function(e){if(e.ok)return e.json();console.log("ERROR")})).then((function(o){e.textContent=o.name,t.textContent=o.about,n.src=o.avatar})).catch((function(e){console.log(e)}))},l=document.querySelector(".elements__grid"),u=document.querySelector(".popup-image"),a=u.querySelector(".popup__image"),s=u.querySelector(".popup__image-title");function d(e,t){e.prepend(t)}function f(e,o){var c=h.cloneNode(!0).content.querySelector(".elements__grid-unit"),i=c.querySelector(".elements__photo"),l=c.querySelector(".elements__info-place"),d=c.querySelector(".elements__delete-icon"),f=c.querySelector(".elements__like-icon"),_=c.querySelector(".elements__like-count");return l.textContent=e,i.src=o,i.alt=e,i.addEventListener("click",(function(){t(u),a.src=i.src,a.alt=l.textContent,s.textContent=l.textContent})),d.addEventListener("click",(function(){t(A),P.addEventListener("submit",(function(e){e.preventDefault(),function(e,t){fetch("".concat(r.url,"cards/").concat(e),{method:"DELETE",headers:r.headers}).then((function(e){if(e.ok)return e.json();console.log("ERROR")})).then((function(){t.remove()})).catch((function(e){console.log(e)}))}(c.dataset.id,c),n(A)}))})),f.addEventListener("click",(function(){var e,t,n;e=c.dataset.id,t=f,n=_,fetch("".concat(r.url,"cards/likes/").concat(e),{method:"PUT",headers:r.headers}).then((function(e){if(e.ok)return e.json();console.log("ERROR")})).then((function(e){t.classList.add("elements__like-icon_active"),n.textContent=e.likes.length})).catch((function(e){console.log(e)})),f.classList.contains("elements__like-icon_active")&&function(e,t,n){fetch("".concat(r.url,"cards/likes/").concat(e),{method:"DELETE",headers:r.headers}).then((function(e){if(e.ok)return e.json();console.log("ERROR")})).then((function(e){t.classList.remove("elements__like-icon_active"),n.textContent=e.likes.length})).catch((function(e){console.log(e)}))}(c.dataset.id,f,_)})),c}var _="form__input_error",m="form__error_visible",p="form__save_disabled",v=function(e){e.classList.add(p),e.disabled=!0},y=function(e,t){var n=e.querySelector(".form__save");!function(e){return e.some((function(e){return!e.validity.valid}))}(t)?function(e){e.classList.remove(p),e.disabled=!1}(n):v(n)};Array.from(document.querySelectorAll(".form")).forEach((function(e){e.addEventListener("submit",(function(e){e.preventDefault()})),function(e){var t=Array.from(e.querySelectorAll(".form__input"));t.forEach((function(n){n.addEventListener("input",(function(){(function(e,t){t.validity.valid?function(e,t){var n=e.querySelector(".".concat(t.id,"__error"));t.classList.remove(_),n.classList.remove(m),n.textContent="error"}(e,t):function(e,t,n){var o=e.querySelector(".".concat(t.id,"__error"));t.classList.add(_),o.textContent=n,o.classList.add(m)}(e,t,t.validationMessage)})(e,n),y(e,t)}))})),y(e,t)}(e)}));var h=document.querySelector("#elements_card"),S=document.querySelector(".popup-profile"),q=S.querySelector(".popup__close"),E=S.querySelector(".form"),k=S.querySelector(".form__field-name"),L=S.querySelector(".form__field-about"),g=document.querySelector(".profile__edit"),b=document.querySelector(".popup-avatar"),R=b.querySelector(".popup__close"),C=b.querySelector(".form"),O=b.querySelector(".form__field-about"),x=document.querySelector(".profile__photo"),j=document.querySelector(".profile__avatar"),A=document.querySelector(".popup-delete"),D=A.querySelector(".popup__close"),P=A.querySelector(".form"),T=document.querySelector(".profile__name"),w=document.querySelector(".profile__text"),I=document.querySelector(".popup-place"),N=I.querySelector(".popup__close"),J=I.querySelector(".form"),H=I.querySelector(".form__field-name"),M=I.querySelector(".form__field-about"),z=document.querySelector(".profile__add"),U=I.querySelector(".form__save"),B=u.querySelector(".popup__close"),F=Array.from(document.querySelectorAll(".popup"));i(T,w,j),fetch("".concat(r.url,"cards"),{headers:r.headers}).then((function(e){if(e.ok)return e.json();console.log("ERROR")})).then((function(e){e.reverse().forEach((function(e){var t=f(e.name,e.link);d(l,t),document.querySelector(".elements__like-count").textContent=e.likes.length,e.owner._id===r.myId&&document.querySelector(".elements__delete-icon").classList.add("elements__delete-icon_visible"),t.dataset.id=e._id,e.likes.forEach((function(e){e._id===r.myId&&document.querySelector(".elements__like-icon").classList.add("elements__like-icon_active")}))}))})).catch((function(e){console.log(e)})),J.addEventListener("submit",(function(e){var t,o;e.preventDefault(),t=H,o=M,fetch("".concat(r.url,"cards"),{method:"POST",headers:r.headers,body:JSON.stringify({name:t.value,link:o.value})}).then((function(e){if(e.ok)return e.json();console.log("ERROR")})).then((function(e){var n=f(t.value,o.value);d(l,n),e.owner._id===r.myId&&document.querySelector(".elements__delete-icon").classList.add("elements__delete-icon_visible")})).catch((function(e){console.log(e)})),n(I),H.value="",M.value="",v(U)})),F.forEach((function(e){e.addEventListener("mousedown",o)})),g.addEventListener("click",(function(){t(S),k.value=T.textContent,L.value=w.textContent})),q.addEventListener("click",(function(){n(S)})),x.addEventListener("click",(function(){t(b)})),R.addEventListener("click",(function(){n(b)})),z.addEventListener("click",(function(){t(I)})),N.addEventListener("click",(function(){n(I)})),D.addEventListener("click",(function(){n(A)})),B.addEventListener("click",(function(){n(u)})),E.addEventListener("submit",(function(e){var t,o;e.preventDefault(),t=k,o=L,fetch("".concat(r.url,"users/me"),{method:"PATCH",headers:r.headers,body:JSON.stringify({name:t.value,about:o.value})}).then((function(e){if(e.ok)return e.json();console.log("ERROR")})).catch((function(e){console.log(e)})),n(S),i(T,w,j)})),C.addEventListener("submit",(function(e){var t;e.preventDefault(),t=O,fetch("".concat(r.url,"users/me/avatar"),{method:"PATCH",headers:r.headers,body:JSON.stringify({avatar:t.value})}).then((function(e){if(e.ok)return e.json();console.log("ERROR")})).catch((function(e){console.log(e)})),i(T,w,j),n(b)}))})();