(()=>{"use strict";var e={d:(t,o)=>{for(var r in o)e.o(o,r)&&!e.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:o[r]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t)};function t(e){e.classList.add("popup_opened"),document.addEventListener("keydown",n)}function o(e){e.classList.remove("popup_opened"),document.removeEventListener("keydown",n)}function r(e){var t=document.querySelector(".popup_opened");e.target.classList.contains("popup")&&o(t)}function n(e){var t=document.querySelector(".popup_opened");"Escape"===e.key&&o(t)}e.d({},{S7:()=>O,$Q:()=>N,ST:()=>D,gf:()=>E,Iv:()=>b});var c=document.querySelector("#elements_card"),u=document.querySelector(".elements__grid"),i=document.querySelector(".popup-image"),l=i.querySelector(".popup__image"),a=i.querySelector(".popup__image-title");function s(e,t){e.prepend(t)}function d(e,o){var r=c.cloneNode(!0).content.querySelector(".elements__grid-unit"),n=r.querySelector(".elements__photo"),u=r.querySelector(".elements__info-place"),s=r.querySelector(".elements__delete-icon"),d=r.querySelector(".elements__like-icon");return u.textContent=e,n.src=o,n.alt=e,n.addEventListener("click",(function(){t(i),l.src=n.src,l.alt=u.textContent,a.textContent=u.textContent})),s.addEventListener("click",(function(){r.remove()})),d.addEventListener("click",(function(){d.classList.toggle("elements__like-icon_active")})),r}var f="form__input_error",p="form__error_visible",m="form__save_disabled",_=function(e){e.classList.add(m),e.disabled=!0},v=function(e,t){var o=e.querySelector(".form__save");!function(e){return e.some((function(e){return!e.validity.valid}))}(t)?function(e){e.classList.remove(m),e.disabled=!1}(o):_(o)};Array.from(document.querySelectorAll(".form")).forEach((function(e){e.addEventListener("submit",(function(e){e.preventDefault()})),function(e){var t=Array.from(e.querySelectorAll(".form__input"));t.forEach((function(o){o.addEventListener("input",(function(){(function(e,t){t.validity.valid?function(e,t){var o=e.querySelector(".".concat(t.id,"__error"));t.classList.remove(f),o.classList.remove(p),o.textContent="error"}(e,t):function(e,t,o){var r=e.querySelector(".".concat(t.id,"__error"));t.classList.add(f),r.textContent=o,r.classList.add(p)}(e,t,t.validationMessage)})(e,o),v(e,t)}))})),v(e,t)}(e)}));var y={url:"https://nomoreparties.co/v1/plus-cohort7/",myId:"e5c6b7df9e7fbe0fcc954a79",headers:{authorization:"55f6dcbe-e189-42c3-b858-3cc6208e5fc5","Content-Type":"application/json"}},S=function(e,t){return fetch("https://nomoreparties.co/v1/plus-cohort7/users/me",{headers:{authorization:"55f6dcbe-e189-42c3-b858-3cc6208e5fc5"}}).then((function(e){if(e.ok)return e.json();console.log("ERROR")})).then((function(o){var r=document.querySelector(".profile__avatar");e.textContent=o.name,t.textContent=o.about,r.src=o.avatar})).catch((function(e){console.log(e)}))},h=document.querySelector(".popup-profile"),q=h.querySelector(".popup__close"),L=h.querySelector(".form"),b=h.querySelector(".form__field-name"),E=h.querySelector(".form__field-about"),k=document.querySelector(".profile__edit"),g=document.querySelector(".popup-avatar"),C=g.querySelector(".popup__close"),x=g.querySelector(".form"),O=g.querySelector(".form__field-about"),A=document.querySelector(".profile__photo"),R=document.querySelector(".profile__name"),j=document.querySelector(".profile__text"),w=document.querySelector(".popup-place"),P=w.querySelector(".popup__close"),T=w.querySelector(".form"),D=w.querySelector(".form__field-name"),N=w.querySelector(".form__field-about"),z=document.querySelector(".profile__add"),I=w.querySelector(".form__save"),J=i.querySelector(".popup__close"),H=Array.from(document.querySelectorAll(".popup"));T.addEventListener("submit",(function(e){e.preventDefault();var t=d(D.value,N.value);s(u,t),o(w),fetch("https://nomoreparties.co/v1/plus-cohort7/cards",{method:"POST",headers:y.headers,body:JSON.stringify({name:D.value,link:N.value})}),D.value="",N.value="",_(I)})),H.forEach((function(e){e.addEventListener("mousedown",r)})),k.addEventListener("click",(function(){t(h),b.value=R.textContent,E.value=j.textContent})),q.addEventListener("click",(function(){o(h)})),A.addEventListener("click",(function(){t(g)})),C.addEventListener("click",(function(){o(g)})),z.addEventListener("click",(function(){t(w)})),P.addEventListener("click",(function(){o(w)})),J.addEventListener("click",(function(){o(i)})),L.addEventListener("submit",(function(e){e.preventDefault(),fetch("https://nomoreparties.co/v1/plus-cohort7/users/me",{method:"PATCH",headers:y.headers,body:JSON.stringify({name:b.value,about:E.value})}),o(h),S(R,j)})),x.addEventListener("submit",(function(e){e.preventDefault(),fetch("https://nomoreparties.co/v1/plus-cohort7/users/me/avatar",{method:"PATCH",headers:y.headers,body:JSON.stringify({avatar:O.value})}),o(g),S(R,j)})),S(R,j),fetch("https://nomoreparties.co/v1/plus-cohort7/cards",{headers:{authorization:"55f6dcbe-e189-42c3-b858-3cc6208e5fc5"}}).then((function(e){if(e.ok)return e.json();console.log("ERROR")})).then((function(e){e.forEach((function(e){var t=d(e.name,e.link);s(u,t),document.querySelector(".elements__like-count").textContent=e.likes.length,e.owner._id===y.myId&&document.querySelector(".elements__delete-icon").classList.add("elements__delete-icon_visible")}))})).catch((function(e){console.log(e)}))})();