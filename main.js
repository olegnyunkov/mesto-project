(()=>{"use strict";var e={d:(t,n)=>{for(var o in n)e.o(n,o)&&!e.o(t,o)&&Object.defineProperty(t,o,{enumerable:!0,get:n[o]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t)};function t(e){e.classList.add("popup_opened"),document.addEventListener("keydown",c)}function n(e){e.classList.remove("popup_opened"),document.removeEventListener("keydown",c)}function o(e){var t=document.querySelector(".popup_opened");e.target.classList.contains("popup")&&n(t)}function c(e){var t=document.querySelector(".popup_opened");"Escape"===e.key&&n(t)}e.d({},{OP:()=>y,cM:()=>A,b3:()=>P});var r={url:"https://nomoreparties.co/v1/plus-cohort7/",headers:{authorization:"55f6dcbe-e189-42c3-b858-3cc6208e5fc5","Content-Type":"application/json"}},i=document.querySelector(".elements__grid"),l=document.querySelector(".popup-image"),u=l.querySelector(".popup__image"),a=l.querySelector(".popup__image-title");function s(e,t){e.prepend(t)}function d(e,o){var c=y.cloneNode(!0).content.querySelector(".elements__grid-unit"),i=c.querySelector(".elements__photo"),s=c.querySelector(".elements__info-place"),d=c.querySelector(".elements__delete-icon"),f=c.querySelector(".elements__like-icon"),_=c.querySelector(".elements__like-count");return s.textContent=e,i.src=o,i.alt=e,i.addEventListener("click",(function(){t(l),u.src=i.src,u.alt=s.textContent,a.textContent=s.textContent})),d.addEventListener("click",(function(){t(A),P.addEventListener("submit",(function e(t){var o;t.preventDefault(),(o=c.dataset.id,fetch("".concat(r.url,"cards/").concat(o),{method:"DELETE",headers:r.headers}).then((function(e){if(e.ok)return e.json();console.log("ERROR")}))).then((function(){c.remove(),n(A),P.removeEventListener("submit",e)})).catch((function(e){console.log(e)}))}))})),f.addEventListener("click",(function(){var e;(e=c.dataset.id,fetch("".concat(r.url,"cards/likes/").concat(e),{method:"PUT",headers:r.headers}).then((function(e){if(e.ok)return e.json();console.log("ERROR")}))).then((function(e){f.classList.add("elements__like-icon_active"),_.textContent=e.likes.length})).catch((function(e){console.log(e)})),f.classList.contains("elements__like-icon_active")&&function(e){return fetch("".concat(r.url,"cards/likes/").concat(e),{method:"DELETE",headers:r.headers}).then((function(e){if(e.ok)return e.json();console.log("ERROR")}))}(c.dataset.id).then((function(e){f.classList.remove("elements__like-icon_active"),_.textContent=e.likes.length})).catch((function(e){console.log(e)}))})),c}var f,_="form__input_error",m="form__error_visible",p="form__save_disabled",v=function(e){e.classList.add(p),e.disabled=!0},h=function(e,t){var n=e.querySelector(".form__save");!function(e){return e.some((function(e){return!e.validity.valid}))}(t)?function(e){e.classList.remove(p),e.disabled=!1}(n):v(n)};Array.from(document.querySelectorAll(".form")).forEach((function(e){e.addEventListener("submit",(function(e){e.preventDefault()})),function(e){var t=Array.from(e.querySelectorAll(".form__input"));t.forEach((function(n){n.addEventListener("input",(function(){(function(e,t){t.validity.valid?function(e,t){var n=e.querySelector(".".concat(t.id,"__error"));t.classList.remove(_),n.classList.remove(m),n.textContent="error"}(e,t):function(e,t,n){var o=e.querySelector(".".concat(t.id,"__error"));t.classList.add(_),o.textContent=n,o.classList.add(m)}(e,t,t.validationMessage)})(e,n),h(e,t)}))})),h(e,t)}(e)}));var y=document.querySelector("#elements_card"),S=document.querySelector(".popup-profile"),q=S.querySelector(".popup__close"),E=S.querySelector(".form"),k=S.querySelector(".form__field-name"),L=S.querySelector(".form__field-about"),g=document.querySelector(".profile__edit"),b=document.querySelector(".popup-avatar"),R=b.querySelector(".popup__close"),C=b.querySelector(".form"),x=b.querySelector(".form__field-about"),O=document.querySelector(".profile__photo"),j=document.querySelector(".profile__avatar"),A=document.querySelector(".popup-delete"),D=A.querySelector(".popup__close"),P=A.querySelector(".form"),T=document.querySelector(".profile__name"),w=document.querySelector(".profile__text"),N=document.querySelector(".popup-place"),J=N.querySelector(".popup__close"),H=N.querySelector(".form"),M=N.querySelector(".form__field-name"),z=N.querySelector(".form__field-about"),U=document.querySelector(".profile__add"),B=N.querySelector(".form__save"),F=l.querySelector(".popup__close"),G=Array.from(document.querySelectorAll(".popup"));fetch("".concat(r.url,"users/me"),{headers:r.headers}).then((function(e){if(e.ok)return e.json();console.log("ERROR")})).then((function(e){T.textContent=e.name,w.textContent=e.about,j.src=e.avatar,f=e._id})).catch((function(e){console.log(e)})),fetch("".concat(r.url,"cards"),{headers:r.headers}).then((function(e){if(e.ok)return e.json();console.log("ERROR")})).then((function(e){e.reverse().forEach((function(e){var t=d(e.name,e.link);s(i,t),document.querySelector(".elements__like-count").textContent=e.likes.length,e.owner._id===f&&document.querySelector(".elements__delete-icon").classList.add("elements__delete-icon_visible"),t.dataset.id=e._id,e.likes.forEach((function(e){e._id===f&&document.querySelector(".elements__like-icon").classList.add("elements__like-icon_active")}))}))})).catch((function(e){console.log(e)})),H.addEventListener("submit",(function(e){var t,o;e.preventDefault(),(t=M,o=z,fetch("".concat(r.url,"cards"),{method:"POST",headers:r.headers,body:JSON.stringify({name:t.value,link:o.value})}).then((function(e){if(e.ok)return e.json();console.log("ERROR")}))).then((function(e){var t=d(M.value,z.value);s(i,t),e.owner._id===f&&document.querySelector(".elements__delete-icon").classList.add("elements__delete-icon_visible"),t.dataset.id=e._id,n(N),M.value="",z.value="",v(B)})).catch((function(e){console.log(e)}))})),G.forEach((function(e){e.addEventListener("mousedown",o)})),g.addEventListener("click",(function(){t(S),k.value=T.textContent,L.value=w.textContent})),q.addEventListener("click",(function(){n(S)})),O.addEventListener("click",(function(){t(b)})),R.addEventListener("click",(function(){n(b)})),U.addEventListener("click",(function(){t(N)})),J.addEventListener("click",(function(){n(N)})),D.addEventListener("click",(function(){n(A)})),F.addEventListener("click",(function(){n(l)})),E.addEventListener("submit",(function(e){var t,o;e.preventDefault(),(t=k,o=L,fetch("".concat(r.url,"users/me"),{method:"PATCH",headers:r.headers,body:JSON.stringify({name:t.value,about:o.value})}).then((function(e){if(e.ok)return e.json();console.log("ERROR")}))).then((function(){var e,t;e=k,t=L,T.textContent=e.value,w.textContent=t.value,n(S)})).catch((function(e){console.log(e)}))})),C.addEventListener("submit",(function(e){var t;e.preventDefault(),(t=x.value,fetch("".concat(r.url,"users/me/avatar"),{method:"PATCH",headers:r.headers,body:JSON.stringify({avatar:t})}).then((function(e){if(e.ok)return e.json();console.log("ERROR")}))).then((function(){!function(e){j.src=e}(x.value),n(b)})).catch((function(e){console.log(e)}))}))})();